\documentclass[a4paper]{article}
\usepackage{lmodern}

\usepackage{mathtools}

\usepackage{array}
\usepackage{booktabs}
\usepackage{multicol}

\usepackage[margin=1cm]{geometry}
\usepackage{diffcoeff}
\diffdef { p }
{
    op-symbol = \partial ,
    left-delim = \left .,
    right-delim = \right | ,
    subscr-nudge = 0 mu
}
\usepackage{mleftright}
\mleftright

\usepackage{pdflscape}
\usepackage{sagetex}

% https://tex.stackexchange.com/questions/281862/drawing-a-double-line
\newcommand{\doublerule}[1][.4pt]{%
  \noindent
  \makebox[0pt][l]{\rule[.7ex]{\linewidth}{#1}}%
  \rule[.3ex]{\linewidth}{#1}}


\begin{document}

\begin{landscape}
    \large
    \centering
    \begin{minipage}{0.480\columnwidth}
        \begin{alignat}{2}
            \diffp{u}{t} - \triangle u & = f  &\quad& \text{ in } \Omega \\
            u & = g  &\quad& \text{ on } \partial\Omega 
        \end{alignat}
    \end{minipage}
    \hfill
    \begin{minipage}{0.480\columnwidth}
        \begin{alignat}{2}
            \diffp{u}{t} - \nabla \cdot \left(D\left(u\right) \nabla u\right) & = 0  &\quad& \text{ in } \Omega  \\
            D(u) \diffp{u}{x}{0} = -\beta; & \quad   D(u) \diffp{u}{x}{1} = 0 
        \end{alignat}
    \end{minipage}

    \bigskip
    \noindent\rule{\columnwidth}{1pt}

    \begin{minipage}{0.4800\columnwidth}
        \begin{equation}
            \frac{u^n - u^{n-1}}{k_n} - \triangle \left(\left(1-\theta\right)u^{n-1} + \theta u^n\right) \\ = \left(1-\theta\right)f\left(x,t_{n-1}\right) + \theta f\left(x,t_n\right)
        \end{equation}
    \end{minipage}
    \hfill
    \begin{minipage}{0.4800\columnwidth}
        \begin{alignat}{2}
            \begin{multlined}
                \frac{u^n - u^{n-1}}{k_n} - D\left(u^\ast\right) \left(\left(1-\theta\right)u^{n-1} + \theta\, u^n\right) = 0, \quad  \\
                \qquad\qquad D\left(u^\ast\right) = f(u^{n-k}), \ k = 1,2,\dots m
            \end{multlined} 
        \end{alignat}
    \end{minipage}

    \bigskip
    \noindent\rule{\columnwidth}{1pt}

    \begin{flushleft}
        \underline{Spatial Discretisation}

        \medskip
        $u^n(x) \approx u^n_h(x) \coloneqq \sum_j U^n_j \phi_j(x)$
    \end{flushleft}

    \begin{minipage}{0.480\columnwidth}
        \begin{equation}
            M\frac{U^n - U^{n-1}}{k_n} + A \left(\left(1-\theta\right)U^{n-1} + \theta\, U^n\right) =  \left( 1-\theta \right) F^{n-1} + \theta F^n 
        \end{equation}
    \end{minipage}
    \hfill
    \begin{minipage}{0.4800\columnwidth}
        \begin{equation}
            M\frac{U^n - U^{n-1}}{k_n} + A D(u^*) \left(\left(1-\theta\right)U^{n-1} + \theta\, U^n\right) =  (w\cdot-\beta){\Huge\mid}_{x=0}
        \end{equation} 
    \end{minipage}

    \bigskip
    \noindent\rule{\columnwidth}{1pt}

    \begin{minipage}{0.48\columnwidth}
        \begin{equation}
            \left(M + k_n \theta A\right) U^n = \left(M - k_n A \left(1-\theta\right)\right) U^{n-1} + k_n\left(\left( 1-\theta \right) F^{n-1} + \theta F^n\right)
        \end{equation}
    \end{minipage}
    \hfill
    \begin{minipage}{0.515\columnwidth}
        \begin{equation}
            \left(M + k_n \theta D\left(u^\ast\right) A \right) U^n = \left(M - k_n D\left(u^\ast\right) A \left(1-\theta\right)\right) U^{n-1} + k_n(w\cdot-\beta){\Huge\mid}_{x=0}
        \end{equation} 
        \begin{equation}
            \left(M + k_n \theta D\left(u^\ast\right) A \right) U^n = \left(M - k_n D\left(u^\ast\right) A \left(1-\theta\right)\right) U^{n-1} + \,  {-k_n}\beta\ w\left(0\right)
        \end{equation}
    \end{minipage}

    \newpage

    \setcounter{equation}{0}
    % \bigskip
    % \noindent\doublerule[1pt]
    % \bigskip

    \begin{minipage}{0.51\columnwidth}
        \begin{center}
            \underline{Original (MMS)}
        \end{center}
        \begin{align}
            \!\!\!\diffp{u(x,t)}{t} &= \nabla\!\cdot\!D(x) \nabla u(x,t) - \Sigma_a(x) u(x,t) + S(x,t)   \text{ in } \Omega: (0,b) \times (0,b) \\
            \diffp{u(x,t)}{t} &= \nabla \cdot D\, \nabla u(x,t) - \Sigma_a\, u(x,t) + S(x,t) \text{ in } \Omega: (0,b) \times (0,b) \\
            \diffp{u(x,t)}{t} &= D\, \triangle u(x,t) - \Sigma_a\, u(x,t) + S(x,t) \text{ in } \Omega: (0,b) \times (0,b)
            % \end{align}
            \intertext{Assume $u(x,t) = A \sin\left(\omega t\right)\big(b x - x^2\big)$,}
            % \begin{align}
            u(0,t) &= 0\,; \ u(b,0) = 0 \\[1ex]
            \diffp{u(x,t)}{x}{\mathrlap{x=0}} &= 0\,; \ \diffp{u(x,t)}{x}{\mathrlap{x=b}} = 0
        \end{align}
            \begin{sageblock}
                f(x) = exp(x) * sin(2*x)
            \end{sageblock}

% This is an example $2+2=\sage{2+2}$. If you raise the current year mod
% $100$ (which equals $\sage{mod(\the\year, 100)}$) to the power of the
% current day ($\the\day$), you get $\sage{Integer(mod(\the\year,
% 100))^\the\day}$. Also, $\the\year$ modulo $42$ is $\sage{\the\year
% \percent 42}$.


        \end{minipage}
        \hfill
        \begin{minipage}{0.475\columnwidth}
            \begin{center}
                \underline{Modification from Original (MMS)}
            \end{center}
            \raggedright
            \begin{align}
                \!\!\!\diffp{u(x,t)}{t} &= \nabla\!\cdot\!D(x) \nabla u(x,t) + S(x,t)  \text{ in } \Omega: (0,b),\, b = 1\\
                \diffp{u(x,t)}{t} &= \nabla \cdot D\, \nabla u(x,t) + S(x,t)   \text{ in } \Omega: (0,b),\, b = 1\\
                \diffp{u(x,t)}{t} &= D\, \triangle u(x,t) + S(x,t)  \text{ in } \Omega: (0,b),\, b = 1\\
                \intertext{Assume $u(x,t) = A \sin\left(\omega t\right)\big(b x - x^2\big),\, b=1$,}
                % \begin{align}
                \vphantom{u(0,t) = 0\,; \ u(b,0) = 0,\ b =1} \notag\\[1ex]
                \diffp{u(x,t)}{x}{\mathrlap{x=0}} &= -\beta\,; \ \diffp{u(x,t)}{x}{\mathrlap{\substack{x=b,\\b=1}}} = 0
            \end{align}
        \end{minipage}

\end{landscape}

\end{document}
